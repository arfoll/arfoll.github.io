<!doctype html><html lang=en><head><title>GL.iNet Gls-10 - a POE powered bluetooth gateway :: Blogdini</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="The GL.iNet GL-S10 is a small IoT gateway based on an ESP32 which has the particularity of being POE powered. It&amp;rsquo;s apart from this rather unremarkable which makes it perfect for running ESPHome which is increasingly attractive due to the new bluetooth proxy feature in homeassistant. They&amp;rsquo;re also super hackable and this seems fully supported by the vendor which even gives relatively nice instructions.
Aquiring such devices is pretty easy from the usual sources, I found mine on ebay for ~30eur each since I&amp;rsquo;m impatient and didn&amp;rsquo;t want to wait."><meta name=keywords content=","><meta name=robots content="noodp"><link rel=canonical href=https://arfoll.github.io/posts/gls10/><link rel=stylesheet href=https://arfoll.github.io/assets/style.css><link rel=stylesheet href=https://arfoll.github.io/assets/blue.css><link rel=apple-touch-icon href=https://arfoll.github.io/img/apple-touch-icon-192x192.png><link rel="shortcut icon" href=https://arfoll.github.io/img/favicon/blue.png><meta name=twitter:card content="summary"><meta name=twitter:site content><meta name=twitter:creator content><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="og:title" content="GL.iNet Gls-10 - a POE powered bluetooth gateway"><meta property="og:description" content="The GL.iNet GL-S10 is a small IoT gateway based on an ESP32 which has the particularity of being POE powered. It&amp;rsquo;s apart from this rather unremarkable which makes it perfect for running ESPHome which is increasingly attractive due to the new bluetooth proxy feature in homeassistant. They&amp;rsquo;re also super hackable and this seems fully supported by the vendor which even gives relatively nice instructions.
Aquiring such devices is pretty easy from the usual sources, I found mine on ebay for ~30eur each since I&amp;rsquo;m impatient and didn&amp;rsquo;t want to wait."><meta property="og:url" content="https://arfoll.github.io/posts/gls10/"><meta property="og:site_name" content="Blogdini"><meta property="og:image" content="https://arfoll.github.io/"><meta property="og:image:width" content="2048"><meta property="og:image:height" content="1024"><meta property="article:published_time" content="2022-10-09 07:32:43 +0200 +0200"></head><body class=blue><div class="container headings--one-size"><header class=header><div class=header__inner><div class=header__logo><a href=/><div class=logo>Home</div></a></div><div class=menu-trigger>menu</div></div><nav class=menu><ul class="menu__inner menu__inner--desktop"><li><a href=/about>About</a></li></ul><ul class="menu__inner menu__inner--mobile"><li><a href=/about>About</a></li></ul></nav></header><div class=content><div class=post><h1 class=post-title><a href=https://arfoll.github.io/posts/gls10/>GL.iNet Gls-10 - a POE powered bluetooth gateway</a></h1><div class=post-meta><span class=post-date>2022-10-09
[Updated: 2022-10-09]</span></div><span class=post-tags>#<a href=https://arfoll.github.io/tags/homeassistant/>homeassistant</a>&nbsp;
#<a href=https://arfoll.github.io/tags/bluetooth/>bluetooth</a>&nbsp;</span><div class=post-content><div><p>The <a href=https://www.gl-inet.com/products/gl-s10/>GL.iNet GL-S10</a> is a small IoT gateway based on an ESP32 which has the particularity of being POE powered. It&rsquo;s apart from this rather unremarkable which makes it perfect for running ESPHome which is increasingly attractive due to the new bluetooth proxy feature in homeassistant. They&rsquo;re also super hackable and this seems fully supported by the vendor which even gives relatively nice <a href=https://docs.gl-inet.com/en/3/setup/gl-s10/firmware_compilation_guide/>instructions</a>.</p><p>Aquiring such devices is pretty easy from the usual sources, I found mine on ebay for ~30eur each since I&rsquo;m impatient and didn&rsquo;t want to wait. There are much cheaper ways to use ESPHome but I didn&rsquo;t look all that far.</p><h4 id=versions>Versions<a href=#versions class=hanchor arialabel=Anchor>&#8983;</a></h4><p>There are unfortunately two versions of this device with different ethernet PHYs. I&rsquo;ve no idea which is better and usually there seems to be no way of knowing when buying. Luckily both versions seem supported, in the wild both 2.3 and 1.0 devices are found. Mine are 1.0 devices which I guess means they&rsquo;re old stock.</p><h3 id=esphome-on-the-commandline>ESPHome on the commandline<a href=#esphome-on-the-commandline class=hanchor arialabel=Anchor>&#8983;</a></h3><p>There are many guides for ESPHome but most seem to involve random webpages etc, with a bit of digging I found a much easier way to deal with my devices that I&rsquo;m happy with</p><h4 id=preparation>Preparation<a href=#preparation class=hanchor arialabel=Anchor>&#8983;</a></h4><p>First we&rsquo;ll install esphome and then clone the bluetooth proxies repo we&rsquo;ll use to store our gl-s10 configuration</p><pre tabindex=0><code>pip install --upgrade --user esphome
git clone git@github.com:esphome/bluetooth-proxies.git
cd bluetooth-proxies/
</code></pre><p>If you have a 1.0 device you should modify the proxy file like so:</p><pre tabindex=0><code>--- gl-s10.yaml	2022-10-08 17:14:23.440001644 +0200
+++ gl-s10_v1.0.yaml	2022-10-09 07:04:06.563349749 +0200
@@ -19,22 +19,12 @@
   framework:
     type: arduino
 
-# Configuration fo V2.3 hardware revision
 ethernet:
-  type: IP101
+  type: LAN8720
   mdc_pin: GPIO23
   mdio_pin: GPIO18
   clk_mode: GPIO17_OUT
   phy_addr: 1
-  power_pin: GPIO5
-
-# Comment the above and use this instead for V1.0 revision of the hardware
-# ethernet:
-#   type: LAN8720
-#   mdc_pin: GPIO23
-#   mdio_pin: GPIO18
-#   clk_mode: GPIO17_OUT
-#   phy_addr: 1
</code></pre><p>Then you can compile esphome</p><pre tabindex=0><code>esphome compile gl-s10.yaml
</code></pre><h4 id=flashing>Flashing<a href=#flashing class=hanchor arialabel=Anchor>&#8983;</a></h4><p>Opening the device is pretty easy, there is a small tab in the back which you can use with a 2.5mm flathead screwdriver to pry open. Once open, the unit is just slipped into the casing so just carefully remove it. The easiest way to deal with the device is to solder a small 3 pin header to the GPIO headers on the top left of the board circled in blue in this nice diagram. Once you&rsquo;ve soldered the 3 pins, I used an <a href=https://ftdichip.com/products/ttl-232r-3v3/>FTDI TTL-232R-3V3 cable</a> but any serial port will do, you only need GND, TX & RX.</p><p><img src=/img/gls10/gl-s10-pinout.jpg alt=pinout></p><p><strong>Warning</strong> you should only use POE or Micro USB, using both will damage the unit. In order to avoid any issues, I stuck a small label on the microUSB port.</p><p>Once you have everything hooked up just connect your power source (POE or microUSB) whilst pressing the GPIO mode button (~2s seems to do the trick). Then upload your newly compiled firmware, and reboot by unplugging your power source (note the reset button does not seem to work in the bootloader mode).</p><pre tabindex=0><code>esphome upload gl-s10.yaml --device /dev/ttyUSB0
</code></pre><h4 id=ota-flashing>OTA flashing<a href=#ota-flashing class=hanchor arialabel=Anchor>&#8983;</a></h4><p>After you have ESPHome installed on the device and it&rsquo;s functional, you should not need to use the UART port anymore and can flash directly via IP like this:</p><pre tabindex=0><code>esphome upload gl-s10.yaml --device 192.168.xx.xx
</code></pre><h3 id=adding-to-homassistant>Adding to homassistant<a href=#adding-to-homassistant class=hanchor arialabel=Anchor>&#8983;</a></h3><p>This part is super easy, the device should be automatically detected after a few seconds as long as the network allows this.</p></div></div><div class=pagination><div class=pagination__title><span class=pagination__title-h>Read other posts</span><hr></div><div class=pagination__buttons><span class="button next"><a href=https://arfoll.github.io/posts/veluxkig300/><span class=button__text>Controlling Velux blinds using the KIG 300</span>
<span class=button__icon>â†’</span></a></span></div></div></div></div><footer class=footer><div class=footer__inner><div class="copyright copyright--user"><span>Copyright 2022 - Brendan Le Foll</span>
<span>:: Theme made by <a href=https://twitter.com/panr>panr</a></span></div></div></footer><script src=https://arfoll.github.io/assets/main.js></script>
<script src=https://arfoll.github.io/assets/prism.js></script></div></body></html>